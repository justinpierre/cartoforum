<!DOCTYPE HTML>
<html>
<head>
<title>cartoforum group admin</title>

<link rel="stylesheet" href = "https://cdnjs.cloudflare.com/ajax/libs/ol3/4.4.2/ol.css" type = "text/css">
    <script type=text/javascript>$SCRIPT_ROOT = {{ request.script_root|tojson|safe }}</script>
<link rel="stylesheet" href = "{{ url_for('static', filename='styles/index.css') }}" type = "text/css">
    <script src = "https://cdnjs.cloudflare.com/ajax/libs/ol3/4.4.2/ol.js" type = "text/javascript"></script>
			<script src="https://code.jquery.com/jquery-3.2.1.min.js"
			integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
			crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-3.2.1.min.js"
                    integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
          crossorigin="anonymous"></script>
<script src="{{ url_for('static', filename='javascript/index.js') }}"></script>
<script type = "text/javascript">
function expand(exdiv) {
if ($( "#posts"+exdiv ).css( "display") == "none") {
  $( "#posts"+exdiv ).css( "display", "block");
}
else {
  $( "#posts"+exdiv).css( "display", "none");
}

}

var groupid = {{ groupid }};
</script>
</head>
<body onload = "getThreads(groupid)">
<header id = "loginbar">
<h1 id = "title">cartoforum</h1>
</header>
<div id = "content">
<div id = "addgeojson"></div>
<div id = "description">
<br>
<form action = "group_select.php" method = "POST">
<input type = "submit" class = 'btn bbtn' value = "back to groups" />
</form>
<br><br>
<table id = "threads" class = "admintable">
<tr><th width = "350">Threads</tr></tr>

  echo "</table>";
?>
</span>
<table id = "users" class = "admintable">
  <tr><th>Users</th></tr>
  <tr><td>
<?php
	echo "<form method = 'POST' action = 'invite.php' class = 'invite'>";
	echo "<input type = 'hidden' name = 'groupid' value = '" . $groupname . "'>";
	echo "<input class = 'inviteuserid' name = 'invitee' placeholder = 'invite by username'>";
	echo "<input type = 'submit' class = 'btn wbtn' value = 'send invite'></form>";
?>
  <td><tr>
  <?php
   $query = "Select users.userid, users.username from users INNER JOIN usersgroups ON usersgroups.userid = users.userid WHERE usersgroups.groupid=" . $groupid . ";";
   $result = pg_query($dbconn, $query);
   while ($row = pg_fetch_row($result)) {
     echo "<tr><td>";
     echo $row[1];
     echo "</td><td><input type = 'button' class = 'btn wbtn' value = 'remove' onclick = 'removeUser(" . $row[0] . ", `" . $row[1] . "` , " . $groupid . ")'></td></tr>";
   }
   echo "</table>";
?>
<table id = "tools" class = "admintable">
<tr><th>Admin Tools</th></tr>
<tr><td>
<?php echo "<input type = 'button' class = 'btn wbtn' value = '+geojson' onClick = addGeojson('" . $groupid . "') />\n";?>
</td></tr><tr><td>
<br>
Invite users by email:<br>
<form method = 'POST' action = 'serverops/inviteUsers.php'>
<textarea name = "emails" placeholder = "paste addresses here separated by commas"></textarea>
<?php
echo "<input type = 'hidden' name = 'g' value = '" . $groupid . "'>";
?>
<br>
<input type = "submit" value = "send invites" class = 'btn wbtn'>
</form>
</td></tr>
</table>
<form method = 'POST' action = 'serverops/removeUser.php' id = 'removeUser'>
<input type = "hidden" name = "removeUserValue" id = "removeUserValue">
<input type = "hidden" name = "removeFromGroup" id = "removeFromGroup">
</form>
<form method = 'POST' action = 'serverops/retireThread.php' id = 'retireThread'>
<input type = "hidden" name = "threadid" id = "threadid">
<input type = "hidden" name = "threadGroup" id = "threadGroup">
<input type = "hidden" name = "threadstatus" id = "threadstatus">
</form>
</span>
<br>
<form method = 'POST' action = 'serverops/deletegroup.php' id = 'deletegroupform'>
<input type = "button"  class = 'btn bbtn' value = "Delete Group" onClick = "deleteGroup()">
<?php
echo "<input type = 'hidden' name = 'deletegroupid' value = '" . $groupid . "'>";
?>
</form>
</div>
</div>
<footer>
<span style = "padding-left: 80px;">{{ username }}
<form class = "inlineform" action = "logout.php" method = "POST">
<input type = "submit" class = "btn bbtn" value = "logout" />
</form>
<span style = "float: right; padding-top: 4px;">Created by <a href = "https://twitter.com/jpierre001">Justin Pierre</a></span>
</footer>

</body>
</html>

